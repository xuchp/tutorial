# Canvas API

## 一、颜色、样式和阴影

### 属性

#### 1. fillStyle

**作用**：设置或返回用于填充绘画的颜色、渐变或模式。

**默认值**：#000000

**JavaScript 语法**：`context.fillStyle = color|gradient|pattern;`

**属性值**

| 值       | 描述                                         |
| -------- | -------------------------------------------- |
| color    | 指定绘图填充色的 css 颜色值，默认值是#000000 |
| gradient | 用于填充绘图的渐变对象 (线性或者放射性)      |
| pattern  | 用于填充绘图的 pattern 对象                  |

#### 2. strokeStyle

**作用**：设置或返回用于笔触的颜色、渐变或模式。

**默认值**：#000000

**JavaScript 语法**：`context.strokeStyle = color|gradient|pattern;`

**属性值**

| 值       | 描述                                         |
| -------- | -------------------------------------------- |
| color    | 指定绘图填充色的 css 颜色值，默认值是#000000 |
| gradient | 用于填充绘图的渐变对象 (线性或者放射性)      |
| pattern  | 用于填充绘图的 pattern 对象                  |

#### 3. shadowColor

**作用**：设置或返回用于阴影的颜色

**默认值**：#000000

**JavaScript 语法**：`context.shadowColor=color;`

**属性值**

| 值    | 描述                                 |
| ----- | ------------------------------------ |
| color | 用于阴影的 css 颜色值。默认是#000000 |

#### 4. shadowBlur

**作用**：设置或返回用于阴影的模糊级别

**默认值**：

**JavaScript 语法**：`context.shadowBlur=number`

**属性值**

| 值     | 属性           |
| ------ | -------------- |
| number | 属性的模糊级别 |

#### 5. shadowOffsetX

**作用**：设置或返回阴影与形状的水平距离

shadowOffsetX = 0 指示阴影位于形状的正下方

shadowOffsetX = 20 指示阴影位于形状 left 位置右侧的 20 像素处

shadowOffsetX = -20 指示阴影位于形状 left 位置左侧的 20 像素处

**默认值**：0

**JavaScript 语法**：`context.shadowOffsetX = number;`

**属性值**

| 值     | 描述                                   |
| ------ | -------------------------------------- |
| number | 正值或者负值，定义形状与阴影的水平距离 |

#### 6. shadowOffsetY

**作用**：设置或返回阴影与形状的垂直距离

shadowOffsetY = 0 指示阴影位于形状的正下方

shadowOffsetY = 20 指示阴影位于形状 top 位置下方的 20 像素处

shadowOffsetY = -20 指示阴影位于形状 top 位置上方的 20 像素处

**默认值**：0

**JavaScript 语法**：`context.shadowOffsetY = number;`

**属性值**

| 值     | 描述                                   |
| ------ | -------------------------------------- |
| number | 正值或者负值，定义形状与阴影的垂直距离 |

### 方法

#### 1. createLineGradient()

**作用**：创建线性渐变(用在画布内容上)，渐变可用于填充矩形、圆形、线条、文本等等

该对象作为 [strokeStyle](#_2-strokestyle) 或 [fillStyle](#_1-fillstyle) 属性的值，需要配合 addColorStop() 方法规定不同的颜色，以及在 gradient 对象中的何处定位颜色

**JavaScript 语法**：`context.createLinearGradient(x0, y0, x1, y1)`

**参数值**

| 参数 | 描述                |
| ---- | ------------------- |
| x0   | 渐变开始点的 x 坐标 |
| y0   | 渐变开始点的 y 坐标 |
| x1   | 渐变结束点的 x 坐标 |
| y1   | 渐变结束点的 y 坐标 |

#### 2. createPattern()

**作用**：在指定的方向上重复制定的元素

元素可以是图片、视频，或者其他 \<canvas\> 元素

被重复的元素可用于绘制/填充矩形、圆形或者线条等等。

**JavaScript 语法**：`context.createPattern(image, "repeat|repeat-x|repeat-y|no-repeat");`

**参数值**

| 参数      | 描述                                   |
| --------- | -------------------------------------- |
| image     | 规定要使用的模式的图片、画布或视频元素 |
| repeat    | 默认。该模式下在水平和垂直方向重复     |
| repeat-x  | 该模式只在水平方向重复                 |
| repeat-y  | 该模式只在垂直方向重复                 |
| no-repeat | 该模式只显示一次（不重复）             |

#### 3. createRadialGradient()

**作用**：创建放射状/环形的渐变(用在画布内容上)，渐变可用于填充矩形、圆形、线条、文本等等

该对象作为 [strokeStyle](#_2-strokestyle) 或 [fillStyle](#_1-fillstyle) 属性的值，需要配合 addColorStop() 方法规定不同的颜色，以及在 gradient 对象中的何处定位颜色

**JavaScript 语法**：`context.createRadialGradient(x0, y0, r0, x1, y1, r1)`

**参数值**

| 参数 | 描述                |
| ---- | ------------------- |
| x0   | 渐变开始圆的 x 坐标 |
| y0   | 渐变开始圆的 y 坐标 |
| r0   | 开始圆的半径        |
| x1   | 渐变结束圆的 x 坐标 |
| y1   | 渐变结束圆的 y 坐标 |
| r1   | 结束圆的半径        |

#### 4. addColorStop()

**作用**：规定渐变对象中的颜色和停止位置

addColorStop() 方法与 [createLinearGradient()](#_1-createlinegradient) 和 [createRadialGradient()](#_3-createradialgradient) 一起使用

**注意**：您可以多次调用 addColorStop()方法来改变渐变，如果您不对渐变的对象使用该方法，那么渐变将不可见。为了获得可见的渐变，您需要创建至少一个色标。

**JavaScript 语法**:`gradient.addColorStop(stop,color)`

**参数值**

| 参数  | 描述                                                     |
| ----- | -------------------------------------------------------- |
| stop  | 介于 0.0 与 1.0 之间的值，表示渐变中开始与结束之间的位置 |
| color | 在 stop 位置显示的 CSS 颜色值                            |

## 二、线条样式

### 属性

#### 1. lineCap

**作用**：设置或返回线条的结束端点样式

"round" 和 "square" 会使线条略微变长

**默认值**：butt

**JavaScript 语法**：`context.lineCap = "butt | round | square"`

**属性值**

| 值     | 描述                                 |
| ------ | ------------------------------------ |
| butt   | 默认。向线条的每个末端添加平直的边缘 |
| round  | 向线条的每个末端添加圆形线帽         |
| square | 向线条的每个末端添加正方形线帽       |

#### 2. lineJoin

**作用**：设置或返回两条线相交时，所创建的拐角类型

**注意**："miter" 值受 "[miterLimit](#_4-miterlimit)" 属性的影响

**默认值**：miter

**JavaScript 语法**：`context.lineJoin="bevel|round|miter";`

**属性值**

| 值    | 描述           |
| ----- | -------------- |
| bevel | 创建斜角       |
| round | 创建圆角       |
| miter | 默认。创建尖角 |

#### 3. lineWidth

**作用**：设置或返回当前的线条宽度

**默认值**：1

**JavaScript 语法**：`context.lineWidth = number;`

**属性值**

| 值     | 描述                     |
| ------ | ------------------------ |
| number | 当前线条的宽度，以像素计 |

#### 4. miterLimit

**作用**：设置或返回最大斜接长度

斜接长度指的是在两条线交汇处内角和外角之间的距离

**提示**：只有当 lineJoin 属性为 "miter" 时， miterLimit 才有效。

边角的角度越小，斜接长度就会越大。

为了避免斜接长度过长，我们可以使用 miterLimit 属性。

如果斜接长度超过 miterLimit 的值，边角会以 lineJoin 的 "bevel" 类型来显示(Fig3)

![Miter Limit figure 2](https://raw.githubusercontent.com/xuchp/typora-pics/main/canvas/img_miterlimitBevelFig.gif)

**默认值**：10

**JavaScript 语法**：`context.miterLimit = number;`

**属性值**

| 值     | 描述                                                                                              |
| ------ | ------------------------------------------------------------------------------------------------- |
| number | 正数。规定最大斜接长度，如果斜接长度超过 miterLimit 的值，边角会以 lineJoin 的 "bevel" 类型来显示 |

## 三、矩形

### 方法

#### 1. rect()

**作用**：创建矩形

**提示**：请使用 [stroke()](#_2-stroke) 或 [fill()](#_1-fill) 方法在画布上实际地绘制矩形。

**JavaScript 语法**：`context.rect(x, y, width, height);

**参数值**

| 参数   | 描述                 |
| ------ | -------------------- |
| x      | 矩形左上角的 x 坐标  |
| y      | 矩形左上角的 y 坐标  |
| width  | 矩形的宽度，以像素计 |
| height | 矩形的高度，以像素计 |

#### 2. fillRect()

**作用**：创建“被填充”的矩形。默认的填充颜色是黑色

**提示**：请使用 [fillStyle](#_1-fillstyle) 属性来设置用于填充绘图的颜色、渐变或模式

**JavaScript 语法**：`context.fillRect(x, y, width, height);`

**参数值**

| 参数   | 描述                 |
| ------ | -------------------- |
| x      | 矩形左上角的 x 坐标  |
| y      | 矩形左上角的 y 坐标  |
| width  | 矩形的宽度，以像素计 |
| height | 矩形的高度，以像素计 |

#### 3. strokeRect()

\*作用\*\*：绘制矩形（无填充）。笔触的默认颜色是黑色

**提示**：请使用 [strokeStyle](#_2-strokestyle) 属性来设置笔触的颜色、渐变或模式

**JavaScript 语法**：`context.strokeRect(x, y, width, height);`

**参数值**

| 参数   | 描述                 |
| ------ | -------------------- |
| x      | 矩形左上角的 x 坐标  |
| y      | 矩形左上角的 y 坐标  |
| width  | 矩形的宽度，以像素计 |
| height | 矩形的高度，以像素计 |

#### 4. clearRect()

**作用**：在给定的矩形内清除指定的像素

**JavaScript 语法**：`context.clearRect(x, y, width, height);`

**参数值**

| 参数   | 描述                         |
| ------ | ---------------------------- |
| x      | 要清除的矩形左上角的 x 坐标  |
| y      | 要清除的矩形左上角的 y 坐标  |
| width  | 要清除的矩形的宽度，以像素计 |
| height | 要清除的矩形的高度，以像素计 |

## 四、路径

### 方法

#### 1. fill()

**作用**：填充当前的图像/路径。默认是黑色。

**提示**：请使用 [fillStyle](#_1-fillstyle) 属性来填充另一种颜色/渐变

**注意**：如果路径未关闭，那么 fIll() 方法会从路径结束点到开始点之间添加一条线，已关闭路径（正如 [closePath()](#_5-closepath)一样），然后填充该路径。

**JavaScript 语法**：`context.fill();`

#### 2. stroke()

**作用**：实际地绘制出通过 moveTo() 和 lineTo() 方法定义的路径。默认颜色是黑色。

**提示**：请使用 [strokeStyle](#_2-strokestyle) 属性来填充另一种颜色/渐变

**JavaScript 语法**：`context.stroke();`

#### 3. beginPath()

**作用**：开始一条路径，或者重置当前的路径

**JavaScript 语法**：`context.beginPath();`

#### 4. moveTo()

**作用**：把路径移动到画布中的指定点，不创建线条

**提示**：请使用 [stroke()](#_2-stroke) 方法在画布上绘制确切的路径。

**JavaScript 语法**：`context.moveTo(x, y);`

**参数值**

| 参数 | 描述                    |
| ---- | ----------------------- |
| x    | 路径的目标位置的 x 坐标 |
| y    | 路径的目标位置的 y 坐标 |

#### 5. closePath()

**作用**：创建从当前点到开始点的路径。

**提示**：请使用 [stroke()](#_2-stroke) 方法在画布上绘制确切的路径。

**提示**：请使用 [fill()](#_1-fill) 方法来填充图像(默认是黑色)。请使用 [strokeStyle](#_2-strokestyle) 属性来填充另一种颜色/渐变

**JavaScript 语法**：`context.closePath();`

#### 6. lineTo()

**作用**：添加一个新点，然后创建从该点到画布中最后指定点的线条(该方法并不会创建线条)。

**提示**：请使用 [stroke()](#_2-stroke) 方法在画布上绘制确切的路径。

**JavaScript 语法**：`context.lineTo(x, y);`

**参数值**

| 参数 | 描述                    |
| ---- | ----------------------- |
| x    | 路径的目标位置的 x 坐标 |
| y    | 路径的目标位置的 y 坐标 |

#### 7. clip()

**作用**：从原画布中裁剪任意形状和尺寸。

**提示：**一旦剪切了某个区域，则所有之后的绘图都会被限制在被剪切的区域内（不能访问画布上的其他区域）。您也可以在使用 clip() 方法前通过使用 save() 方法对当前画布区域进行保存，并在以后的任意时间对其进行恢复（通过 restore() 方法）。

**JavaScript 语法**：`context.clip();`

#### 8. quadraticCurveTo()

**作用**：通过使用表示二次贝塞尔曲线的指定控制点，向当前路径添加一个点。

二次贝塞尔曲线需要两个点。第一个点用于二次贝塞尔曲线计算中的控制点，第二个点是曲线的结束点。曲线的开始点是当前路径中的最后一个点。如果路径不存在，那么请使用 [beginPath()](#_3-beginpath) 和 [moveTo()](#_4-moveto) 方法来定义开始点。

![二次贝塞尔曲线](https://raw.githubusercontent.com/xuchp/typora-pics/main/canvas/img_quadraticcurve.gif)

- 开始点：moveTo(20, 20)
- 控制点：quadraticCurveTo(**20**, **100**, 200, 20)
- 结束点：quadraticCurveTo(20, 100, **200**, **20**)

**JavaScript 语法**：`context.quadraticCurveTo(cpx, cpy, x, y);`

**参数值**

| 参数 | 描述                  |
| ---- | --------------------- |
| cpx  | 贝塞尔控制点的 x 坐标 |
| cpy  | 贝塞尔控制点的 y 坐标 |
| x    | 结束点的 x 坐标       |
| y    | 结束点的 y 坐标       |

#### 9. bezierCurveTo()

**作用**：通过使用表示三次贝塞尔曲线的制定控制点，向当前路径添加一个点

三次贝塞尔曲线需要三个点。前两个是用于贝塞尔计算值的控制点，第三个点是曲线的结束点。曲线的开始点是当前路径中最后一个点。如果路径不存在，那么请使用 [beginPath()](#_3-beginpath) 和 [moveTo()](#_4-moveto) 方法来定义开始点。

![三次贝塞尔曲线](https://raw.githubusercontent.com/xuchp/typora-pics/main/canvas/img_beziercurve.gif)

- 开始点：moveTo(20,20)
- 控制点 1：bezierCurveTo(**20,100**,200,100,200,20)
- 控制点 2：bezierCurveTo(20,100,**200,100**,200,20)
- 结束点：bezierCurveTo(20,100,200,100,**200,20**)

**JavaScript 语法**：`context.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y);`

**参数值**

| 参数 | 描述                        |
| ---- | --------------------------- |
| cp1x | 第一个贝塞尔控制点的 x 坐标 |
| cp1y | 第一个贝塞尔控制点的 y 坐标 |
| cp2x | 第二个贝塞尔控制点的 x 坐标 |
| cp2y | 第二个贝塞尔控制点的 y 坐标 |
| x    | 结束点的 x 坐标             |
| y    | 结束点的 y 坐标             |

#### 10. arc()

**作用**：创建弧/曲线(用于创建圆或部分圆)

**提示**：如需通过 `arc()` 来创建圆，请把其实角设置为 0，结束角设置为`2* Math.PI`

**提示**：请使用 [stroke()](#_2-stroke) 或 [fill()](#_1-fill) 方法在画布上绘制实际的弧。

![An arc](https://raw.githubusercontent.com/xuchp/typora-pics/main/canvas/img_arc.gif)

- 中心：arc(**100, 75**, 50, 0 \* Math.PI, 1.5 \* Math.PI)
- 起始角：arc(100, 75, 50, **0 \* Math.PI**, 1.5 \* Math.PI)
- 结束角：arc(100, 75, 50, 0 \* Math.PI, **1.5 \* Math.PI**)

**JavaScript 语法**：`context.arc(x,y,r,sAngle,eAngle,counterclockwise);`

**参数值**

| 参数             | 描述                                                                            |
| ---------------- | ------------------------------------------------------------------------------- |
| x                | 圆的中心的 x 坐标                                                               |
| y                | 圆的中心的 y 坐标                                                               |
| r                | 圆的半径                                                                        |
| sAngle           | 起始角，以弧度计(弧的圆心的三点钟位置是 0 度)                                   |
| eAngle           | 结束角，以弧度计                                                                |
| counterclockwise | 可选。规定应该逆时针还是顺时针绘图。false = 顺时针，true = 逆时针，默认是 false |

#### 11. arcTo()

**作用**：在画布上创建介于两个切线之间的弧、曲线

![img](https://raw.githubusercontent.com/xuchp/typora-pics/main/canvas/img_canvas_arcto.png)

**提示**：请使用 [stroke()](#_2-stroke) 方法在画布上绘制确切的弧

**JavaScript 语法**：`context.arcTo(x1, y1, x2, y2, r);`

**参数值**

| 参数 | 描述                     |
| ---- | ------------------------ |
| x1   | 两切线交点的横坐标       |
| y1   | 两切线交点的纵坐标       |
| x2   | 第二条切线上一点的横坐标 |
| Y2   | 第二条切线上一点的纵坐标 |
| r    | 弧的半径                 |

其中第一条切线上的任意一点的横纵坐标是伤害一次点的位置。

#### 12. isPointPath()

**作用**：如果指定点位于当前路径中，`isPointPath()` 方法返回 true，否则返回 false。

**JavaScript 语法**：`context.isPointpath(x, y)`

**参数值**

| 参数 | 描述            |
| ---- | --------------- |
| x    | 要测试的 x 坐标 |
| y    | 要测试的 y 坐标 |

## 五、转换

### 方法

#### 1. scale()

**作用**：缩放当前绘图至更大或更小

**注意**：如果您对绘图进行缩放，所有之后的绘图也会被缩放。定位也会被缩放。如果您 scale(2, 2)，那么绘图将定位于距离画布左上角两倍远的位置

**JavaScript 语法**：`context.scale(scaleWidth, scaleHeight);`

**参数值**

| 参数        | 描述                                                            |
| ----------- | --------------------------------------------------------------- |
| scaleWidth  | 缩放当前绘图的宽度(1 = 100%， 0.5 = 50% , 2 = 200%，依次类推)。 |
| scaleHeight | 缩放当前绘图的高度(1 = 100%， 0.5 = 50% , 2 = 200%，依次类推)。 |

#### 2. rotate()

**作用**：旋转当前绘图

**注意**：旋转只会影响到旋转完成后的绘图

**JavaScript 语法**：`context.rotate(angle);`

**参数值**

| 参数  | 描述                 |
| ----- | -------------------- |
| angle | 旋转角度，以弧度计。 |

#### 3. translate()

**作用**：重新映射画布上的(0,0)位置

**注意**：当您在`translate()`之后调用诸如`fillRect()`之类的方法时，值会添加到 x 和 y 坐标值上。

![Illustration of the translate() method](https://raw.githubusercontent.com/xuchp/typora-pics/main/canvas/img_translate.gif)

**JavaScript 语法**：`context.translate(x, y);`

**参数值**

| 参数 | 描述                      |
| ---- | ------------------------- |
| x    | 添加到水平坐标(x)上的值。 |
| y    | 添加到水平坐标(y)上的值。 |

#### 4. transform()

**作用**：替换当前绘图的变换矩阵。它以下面描述的矩阵来操作当前的变换矩阵：

a c e

b d f

0 0 1

换句话说，`transform()` 允许您缩放、旋转、移动并倾斜当前的环境。

**注意**：该变换只会影响`transform()` 方法调用之后的绘图

**注意**：`transform()`方法的行为相对于由`rotate()`、`scale()`、`translate()`或`transform()`完成的其他变换。例如：如果您已经将绘图设置为放大两倍，则 `transform()` 方法会把绘图放大两倍，您的绘图最终将放大四倍。

**提示：**请查看 [setTransform()](#_5-settransform) 方法，它不会相对于其他变换来发生行为。

**JavaScript 语法**：`context.transform(a, b, c, d, e, f)`

**参数值**

| 参数 | 描述         |
| ---- | ------------ |
| a    | 水平缩放绘图 |
| b    | 水平倾斜绘图 |
| c    | 垂直倾斜绘图 |
| d    | 垂直缩放绘图 |
| e    | 水平移动绘图 |
| f    | 垂直移动绘图 |

#### 5. setTransfrom()

**作用**：把当前的变换矩阵重置为单位矩阵，然后以相同的参数运行 [transform()](#_4-transform) .

换句话说，`setTransform()`允许您缩放、旋转、移动并倾斜当前的环境

**注意**：该变换只会影响`setTransform()`方法调用之后的绘图

**JavaScript 语法**：`context.setTransform(a, b, c, d, e, f);`

**参数值**

| 参数 | 描述         |
| ---- | ------------ |
| a    | 水平缩放绘图 |
| b    | 水平倾斜绘图 |
| c    | 垂直倾斜绘图 |
| d    | 垂直缩放绘图 |
| e    | 水平移动绘图 |
| f    | 垂直移动绘图 |

## 六、文本

### 属性

#### 1. font

**作用**：设置或返回文本内容当前的字体属性

**默认值**：10px sans-serif

**JavaScript 语法**：`context.font = "italic small-caps bond 12px arial";`

**属性值**

| 值                    | 描述                                                                                                                                         |
| --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| font-style            | 规定字体的样式。可能的值<br>- normal <br>- italic<br>- oblique                                                                               |
| font-variant          | 规定字体变体。可能的值：<br>normal<br>small-caps                                                                                             |
| font-weight           | 规定字体的粗细。可能的值<br/> normal<br/>bold<br/>bolder<br/>lighter<br/>100<br/>200<br/>300<br/>400<br/>500<br/>600<br/>700<br/>800<br/>900 |
| font-size/line-height | 规定字号和行高，以像素计                                                                                                                     |
| font-family           | 规定字体系列                                                                                                                                 |
| caption               | 使用标题控制的字体(比如按钮、下拉列表等)。                                                                                                   |
| icon                  | 使用用于标记图标的字体                                                                                                                       |
| menu                  | 使用用于菜单中的字体(下拉列表和菜单列表)                                                                                                     |
| message-box           | 使用用于对话框的字体                                                                                                                         |
| small-caption         | 使用用于标记小型控件的字体                                                                                                                   |
| status-bar            | 使用用于窗口状态栏的字体                                                                                                                     |

#### 2. textAlign

**作用**：设置或返回文本内容的当前对齐方式

通常，文本会从指定位置**开始**，不过，如果您设置为 `textAlign="right"`并将文本放置到 位置 150，那么会在位置 150**结束**。

**提示**：请使用 [fillText()](#1_filltext) 或 [strokeText()](#_2-stroketext) 方法在画布上实际地绘制并定位文本。

![img](https://raw.githubusercontent.com/xuchp/typora-pics/main/canvas/u%253D2622540504%252C2116527914%2526fm%253D253%2526fmt%253Dauto%2526app%253D138%2526f%253DPNG.png)

**默认值**：start

**JavaScript 语法**：`context.textAlign = "center | end | left | right | start";`

**属性值**

| 值     | 描述                         |
| ------ | ---------------------------- |
| start  | 默认。文本在指定的位置开始   |
| end    | 文本在指定的位置结束         |
| center | 文本的中心被放置在指定的位置 |
| left   | 文本在指定的位置开始         |
| right  | 文本在指定的位置结束         |

#### 3. textBaseline

**作用**： 设置或返回在绘制文本时使用的当前文本基线。

![textBaseline illustration](https://raw.githubusercontent.com/xuchp/typora-pics/main/canvas/img_textbaseline.gif)

**注意**： [fillText()](#1_filltext) 或 [strokeText()](#_2-stroketext) 方法在画布上定位文本时，将使用指定的 textBaseline 值

**默认值**:alphabetic

**JavaScript 语法**：`context.textBaseline = "alphabetic | top | hanging | middle | ideographic | bottom";`

**属性值**

| 值          | 描述                           |
| ----------- | ------------------------------ |
| alphabetic  | 默认。文本基线是普通的字母基线 |
| top         | 文本基线是 em 方框的顶端       |
| hanging     | 文本基线是悬挂基线             |
| middle      | 文本基线是 em 方框的正中       |
| ideographic | 文本基线是表意基线             |
| bottom      | 文本基线是 em 方框的底端       |

### 方法

#### 1. fillText()

**作用**： 在画布上绘制"被填充的"文本。默认的颜色是黑色

**提示**：请使用 [font()](#_1-font) 属性来定义字体和字号，并使用 [fillStyle](#_1-fillstyle) 属性以另一种颜色/渐变来渲染文本。

**JavaScript 语法**：`context.fillText(text, x, y, maxWidth);`

**参数值**

| 参数     | 描述                                    |
| -------- | --------------------------------------- |
| text     | 规定在画布上输出的文本                  |
| x        | 开始绘制文本的 x 坐标的位置(相对于画布) |
| y        | 开始绘制文本的 y 坐标的位置(相对于画布) |
| maxWidth | 可选。允许的最大文本宽度，以像素计。    |

#### 2. strokeText()

**作用**：在画布上绘制文本（无填充色）。文本的默认颜色是黑色。

**提示**：请使用 [font()](#_1-font) 属性来定义字体和字号，并使用 [fillStyle](#_1-fillstyle) 属性以另一种颜色/渐变来渲染文本。

**JavaScript 语法**：`context.strokeText(text, x, y, maxWidth);`

**参数值**

| 参数     | 描述                                    |
| -------- | --------------------------------------- |
| text     | 规定在画布上输出的文本                  |
| x        | 开始绘制文本的 x 坐标的位置(相对于画布) |
| y        | 开始绘制文本的 y 坐标的位置(相对于画布) |
| maxWidth | 可选。允许的最大文本宽度，以像素计。    |

#### 3. measureText()

**作用**：返回包含指定文本宽度的对象。

**提示**：如果您需要在文本向画布输出之前，就了解文本的宽度，那么请使用该方法

**JavaScript 语法**：`context.measureText(text).width`

**参数值**

| 参数 | 描述         |
| ---- | ------------ |
| text | 要测量的文本 |

## 七、图像绘制

### 方法

#### 1. drawImage()

**作用**：向画布上绘制图像、画布或视频

\*JavaScript 语法\*\*

| 用法                                                                 | 描述                                     |
| -------------------------------------------------------------------- | ---------------------------------------- |
| context.drawImage(img, x, y)                                         | 在画布上定位图像                         |
| context.drawImage(img, x, y, width, height)                          | 在画布上定位图像，并规定图像的宽度和高度 |
| context.drawImage(img, sx, sy, swidth, sheight, x, y, width, height) | 剪切图像，并在画布上定位被剪切的部分     |

**参数值**

| 参数    | 描述                                       |
| ------- | ------------------------------------------ |
| img     | 规定要使用的图像、画布或视频               |
| sx      | 可选，开始剪切的 x 坐标位置                |
| sy      | 可选，开始剪切的 y 坐标位置                |
| swidth  | 可选，被剪切图像的宽度                     |
| sheight | 可选。被剪切图像的高度                     |
| x       | 在画布上放置图像的 x 坐标位置              |
| y       | 在画布上放置图像的 y 坐标位置              |
| width   | 可选。要使用的图像的宽度(伸展或者缩小图像) |
| eight   | 可选。要使用的图像的高度(伸展或者缩小图像) |

## 八、像素操作

### 属性

#### 1. width

**作用**：返回 ImageData 对象的宽度，以像素计

**JavaScript 语法**：`imgData.width`

#### 2. height

**作用**：返回 ImageData 对象的高度，以像素计

**JavaScript 语法**：`imgData.height`

#### 3. data

**作用**：返回一个对象，其包含指定的 ImageData 对象的图像数据。

对于 ImageData 对象中的每个像素，都存在着四方面的信息，即 RGBA 值：

R - 红色(0-255)

G - 绿色(0-255)

B - 蓝色(0-255)

A - alpha 通道(0-255；0 是透明，255 是完全可见)

color/alpha 信息以数组形式存在，并存储于 ImageData 对象的 data 属性中。

**JavaScript 语法**：`imgData.data`

**参数值**

### 方法

#### 1. createImageData()

**作用**：创建新的空白 ImageData 对象。新对象默认像素值 transparent black。

对于 ImageData 对象中的每个像素，都存在着四方面的信息，即 RGBA 值：

R - 红色(0-255)

G - 绿色(0-255)

B - 蓝色(0-255)

A - alpha 通道(0-255；0 是透明，255 是完全可见)

因此，transparent black 表示(0,0,0,0)

color/alpha 信息以数组形式存在，并且由于数组包含了每个像素的四条信息，所以数组的大小是 ImageData 对象的四倍：width _ height _ 4。(获取数组大小有更简单的办法，就是使用 `ImageDataObject.data.length`)

**提示**：操作完成数组的 color/alpha 信息后，您可以使用 [putImageData()](#_3-putimagedata) 方法将图像数据拷贝回画布上。

**JavaScript 语法**

| 用法                                  | 描述                                                                             |
| ------------------------------------- | -------------------------------------------------------------------------------- |
| context.createImageData(width,height) | 以指定的尺寸(像素)创建新的 ImageData 对象                                        |
| context.createImageData(imageData)    | 创建与指定的另一个 ImageData 对象出现相同的新的 ImageData 对象(不会复制图像数据) |

**参数值**

| 参数      | 描述                           |
| --------- | ------------------------------ |
| width     | ImageData 对象的宽度，以像素计 |
| height    | ImageData 对象的高度，以像素计 |
| imageData | 另一个 ImageData 对象          |

#### 2. getImageData()

**作用**：返回 ImageData 对象，该对象拷贝了画布指定矩形的像素数据。

**注意**：ImageData 对象不是图像，它规定了画布上一部分(矩形)，并保存了该矩形内每个像素的信息。

**JavaScript 语法**：`context.getImageData(x, y, width, height);`

**参数值**

| 参数   | 描述                                    |
| ------ | --------------------------------------- |
| x      | 开始复制的左上角位置的 x 坐标(以像素计) |
| y      | 开始复制的左上角位置的 y 坐标(以像素计) |
| width  | 要复制的矩形区域的宽度                  |
| height | 要复制的矩形区域的高度                  |

#### 3. putImageData()

**作用**：将图像数据（从指定的 ImageData 对象）放回画布上。

**JavaScript 语法**：`context.putImageData(imgData, x, y, dirtyX, dirtyY, dirtyWidth, dirtyHeight)`

**参数值**

| 参数        | 描述                                                |
| ----------- | --------------------------------------------------- |
| imgData     | 规定要放回画布上的 ImageData 对象。                 |
| x           | ImageData 对象左上角的 x 坐标，以像素计。           |
| y           | ImageData 对象左上角的 y 坐标，以像素计。           |
| dirtyX      | 可选。水平值(x)，以像素计，在画布上放置图像的位置。 |
| dirtyY      | 可选。垂直值(y)，以像素计，在画布上放置图像的位置   |
| dirtyWidth  | 可选。在画布上绘制图像所使用的宽度。                |
| dirtyHeight | 可选。在画布上绘制图像所使用的高度。                |

## 九、合成

### 属性

#### 1. globalAlpha

**作用**：设置或返回绘图的当前 alpha 或透明值(alpha 或 transparency)。

globalAlpha 属性值必须是介于 0.0（完全透明） 与 1.0（不透明） 之间的数字。

**默认值**：1.0

**JavaScript 语法**：`context.globalAlpha=number;`

**属性值**

| 值     | 描述                                               |
| ------ | -------------------------------------------------- |
| number | 透明值。必须介于 0.0(完全透明) 与 1.0(不透明) 之间 |

#### 2. globalCompositeOperation

**作用**：设置或返回新图像如何绘制到已有的图像上。

新图像：您打算放置到画布上的绘图。

目标图像：您已经放置在画布上的绘图。

**默认值**：source-over

**JavaScript 语法**：`context.globalCompositeOperation="source-in";`

**属性值**

| 值               | 描述                                                                             |
| ---------------- | -------------------------------------------------------------------------------- |
| source-over      | 默认。在目标图像上显示源图像                                                     |
| source-atop      | 在目标图像顶部显示源图像。源图像位于目标图像之外的部分是不可见的。               |
| source-in        | 在目标图像中显示源图像，只有目标图像之内的源图像部分会显示，目标图像是透明的     |
| source-out       | 在目标图像之外显示源图像，只有目标图像之外的源图像部分会显示，目标图像是透明的   |
| destination-over | 在源图像上显示目标图像                                                           |
| destination-atop | 在源图像顶部显示目标图像。目标图像位于源图像之外的部分是不可见的                 |
| destination-in   | 在源图像中显示目标图像。只有源图像之内的目标图像部分会被显示，源图像是透明的     |
| destination-out  | 在源图像之外显示目标图像。只有源图像之外的目标图像部分会被显示，源图像是透明的。 |
| lighter          | 显示源图像+目标图像                                                              |
| copy             | 显示源图像。忽略目标图像                                                         |
| xor              | 使用异或操作对源图像和目标图像进行组合。                                         |

![image-20240530142857949](https://raw.githubusercontent.com/xuchp/typora-pics/main/canvas/image-20240530142857949.png)

## 十、其他

### 方法

#### 1. save()

**作用**：保存当前环境的状态

Canvas 状态存储在栈中，每当 save()方法被调用后，当前的状态就被推送到栈中保存。可以调用任意多次 save 方法

#### 2. restore()

**作用**：返回之前保存过的路径状态和属性

每一次调用 restore 方法，上一个保存的状态就从栈中弹出，所有设定都恢复。(类似数组的 pop())

#### 3. createEvent()

#### 4. getContext()

**作用**：返回一个对象，指出访问绘图功能必要的 API

**JavaScript 语法**：`canvas.getContext(contextID)`

#### 5. toDataURL()

**作用**：返回 canvas 图像的 URL，常用于导出

**JavaScript 语法**：`canvas.toDataURL(type,encoderOptions)`

**参数值**

| 参数          | 描述                                                                                                                         |
| ------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| type          | 图片格式 默认 image/png,image/jpeg,image/webp                                                                                |
| encoderOption | 在指定图片格式为 image/jpeg 或 image/webp 的情况下,可以从 0 到 1 的区间内选择图片的质量 如果超出取值范围 将会使用默认值 0.92 |
